<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NepHR App</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#508C7F">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.png">

    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #508C7F; font-family: sans-serif; }
        
        /* Splash Screen Style */
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #508C7F; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 9999;
            transition: opacity 0.5s ease;
        }
        #splash img { width: 100px; height: 100px; margin-bottom: 20px; border-radius: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .loader {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #ffffff;
            border-radius: 50%; width: 30px; height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        iframe { width: 100%; height: 100%; border: none; display: none; }
    </style>
</head>
<body>

    <!-- Instant Splash Screen -->
    <div id="splash">
        <img src="icon.png" alt="Logo">
        <div class="loader"></div>
        <p style="color: white; margin-top: 15px; font-size: 14px; letter-spacing: 1px;">Loading NepHR...</p>
    </div>

    <!-- Hidden Iframe -->
    <iframe id="appFrame" src="https://script.google.com/macros/s/AKfycbxuviY7LYQyFN4fJZ4_mAaYzf1pTyQ7qkFrbcSOZPt6WHJd9tX-eY2w87NOwOqMu42f/exec" allow="geolocation"></iframe>

    <script>
        const frame = document.getElementById('appFrame');
        const splash = document.getElementById('splash');

        // Hide splash only when Google Script is fully loaded
        frame.onload = function() {
            splash.style.opacity = '0';
            setTimeout(() => {
                splash.style.display = 'none';
                frame.style.display = 'block';
            }, 500);
        };

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
